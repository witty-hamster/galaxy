[TOC]

# ğŸ¹ [åŸºç¡€] çº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µã€å¸¸ç”¨æ–¹æ³•ã€çº¿ç¨‹çŠ¶æ€

> æ¦‚è¿°ï¼š
>
> - ç¨‹åºã€è¿›ç¨‹ã€çº¿ç¨‹
> - çº¿ç¨‹çš„åˆ›å»ºæ–¹å¼ï¼Œå®ç°Runnableæ¥å£æˆ–ç»§æ‰¿Threadç±»
> - çº¿ç¨‹çš„çŠ¶æ€ï¼šåˆ›å»ºã€å°±ç»ªã€è¿è¡Œã€é˜»å¡ã€æ¶ˆäº¡ï¼ˆæ ‡å‡†çš„äº”æ€æ¨¡å‹ï¼‰
> - çº¿ç¨‹å†»ç»“ï¼ˆé˜»å¡ï¼‰çš„å‡ ç§æƒ…å†µ
>   - è°ƒç”¨è¯¥çº¿ç¨‹å¯¹è±¡çš„ wait()æ–¹æ³•
>   - è¯¥çº¿ç¨‹æœ¬èº«è°ƒç”¨ sleep()æ–¹æ³•
>   - è¯¥çº¿ç¨‹ä¸å¦ä¸€ä¸ªçº¿ç¨‹çš„ joinåœ¨ä¸€èµ·
> - çº¿ç¨‹è§£å†»çš„å‡ ç§æƒ…å†µ
>   - è¯¥çº¿ç¨‹å¯¹è±¡çš„ notify()å”¤é†’
>   - sleep()æ–¹æ³•ä¼‘çœ æ—¶é—´å·²åˆ°
> - run()æ–¹æ³•æ‰§è¡Œç»“æŸï¼Œçº¿ç¨‹è¿›å…¥æ¶ˆäº¡çŠ¶æ€
> - å½“å¤šä¸ªå¯¹è±¡æ“çºµåŒä¸€å…±äº«èµ„æºæ—¶ï¼Œè¦ä½¿ç”¨åŒæ­¥æ–¹æ³•æˆ–åŒæ­¥ä»£ç å—æ¥è¿›è¡Œèµ„æºçš„åŒæ­¥å¤„ç†
> - è¿‡å¤šçš„åŒæ­¥å°†äº§ç”Ÿæ­»é”
> - ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…é—®é¢˜ï¼ˆåŒæ­¥ã€ç­‰å¾…ä¸å”¤é†’ï¼‰

## çº¿ç¨‹æ¦‚å¿µ

- ç¨‹åºï¼šProgramï¼Œæ˜¯ä¸€ä¸ªæŒ‡ä»¤çš„é›†åˆ
- è¿›ç¨‹ï¼šProcessï¼Œæ˜¯ä¸€ä¸ªé™æ€çš„æ¦‚å¿µï¼ˆæ­£åœ¨æ‰§è¡Œä¸­çš„ç¨‹åºï¼‰
  - è¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€æ¬¡é™æ€æ‰§è¡Œè¿‡ç¨‹ï¼Œå ç”¨ç‰¹å®šçš„åœ°å€ç©ºé—´
  - æ¯ä¸ªè¿›ç¨‹éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œç”±3éƒ¨åˆ†ç»„æˆï¼ŒCPUã€DATAã€CODE
  - ç¼ºç‚¹ï¼šå†…å­˜çš„æµªè´¹ï¼ŒCPUçš„è´Ÿæ‹…
- çº¿ç¨‹ï¼šæ˜¯è¿›ç¨‹ä¸­ä¸€ä¸ª "å•ä¸€çš„è¿ç»­æ§åˆ¶æµç¨‹"ï¼ˆa singles Thread, equential flow of controlï¼‰
  - çº¿ç¨‹åˆè¢«ç§°ä¸º**è½»é‡çº§è¿›ç¨‹**ï¼ˆlightweight processï¼‰
  - Threads run at the same time, independently of one another
  - ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æ‹¥æœ‰å¤šä¸ªå¹¶è¡Œçš„ï¼ˆconcurrentï¼‰çº¿ç¨‹
  - ä¸€ä¸ªè¿›ç¨‹ä¸­çš„çº¿ç¨‹å…±äº«ç›¸åŒçš„å†…å­˜å•å…ƒã€å†…å­˜åœ°å€ç©ºé—´ --> å¯ä»¥è®¿é—®ç›¸åŒçš„å˜é‡å’Œå¯¹è±¡ï¼›è€Œä¸”å®ƒä»¬ä»åŒä¸€ä¸ªå †ä¸­åˆ†é…å¯¹è±¡ --> é€šä¿¡ã€æ•°æ®äº¤æ¢ã€åŒæ­¥æ“ä½œ
  - ç”±äºçº¿ç¨‹é—´çš„é€šä¿¡æ˜¯åœ¨åŒä¸€åœ°å€ç©ºé—´ä¸Šè¿›è¡Œçš„ï¼Œæ‰€ä»¥ä¸éœ€è¦é¢å¤–çš„é€šä¿¡æœºåˆ¶ï¼Œè¿™å°±ä½¿å¾—é€šä¿¡æ›´ç®€ä¾¿è€Œä¸”ä¿¡æ¯ä¼ é€’çš„é€Ÿåº¦ä¹Ÿæ›´å¿«



## è¿›ç¨‹ä¸çº¿ç¨‹

- ä¸€ä¸ªè¿›ç¨‹ä¸­è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹
  - ç”¨å›¾è¯´è¯ï¼Œå±•ç¤ºè¿›ç¨‹ä¸çº¿ç¨‹
    ![image-20220616104530607](images/image-20220616104530607.png)



## javac ä¸ java

### å›¾è§£è¯´æ˜

![image-20220616104625619](images/image-20220616104625619.png)

- æ ¹æ®å›¾è§£åˆ†æ
  1. ç¼–è¯‘`javac` --> å¯åŠ¨äº†javaçš„ç¼–è¯‘å™¨ï¼Œjavacå°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼Œç¼–è¯‘ç»“æŸåï¼Œæ‰§è¡Œç»“æŸï¼Œæ¶ˆå¤±
  2. æ‰§è¡Œ`java` --> å¯åŠ¨javaè™šæ‹Ÿæœºï¼Œjavaè¿è¡Œè¿›ç¨‹



### Javaè™šæ‹Ÿæœºæè¿°

- Javaè™šæ‹Ÿæœºå¯åŠ¨çš„æ—¶å€™ä¼šæœ‰ä¸€ä¸ªè¿›ç¨‹ java.exeï¼ˆWindowsä¸­åç¼€ä¸º.exeï¼‰ï¼Œè¯¥è¿›ç¨‹ä¸­è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œè´Ÿè´£javaç¨‹åºçš„æ‰§è¡Œã€‚è€Œä¸”è¿™ä¸ªçº¿ç¨‹è¿è¡Œçš„ä»£ç å­˜åœ¨äºmainæ–¹æ³•ä¸­ï¼Œè¯¥çº¿ç¨‹ç§°ä¹‹ä¸ºä¸»çº¿ç¨‹ã€‚
- ä¸€ä¸ªè¿›ç¨‹ä¸­çš„çº¿ç¨‹å…±äº«ä»£ç å’Œæ•°æ®ç©ºé—´ã€‚
- çº¿ç¨‹ç»“æŸï¼Œè¿›ç¨‹æœªå¿…ç»“æŸï¼Œä½†è¿›ç¨‹ç»“æŸï¼Œçº¿ç¨‹ä¸€å®šç»“æŸã€‚
- è¿›ç¨‹ä¸­åŒ…å«çº¿ç¨‹ï¼Œçº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€éƒ¨åˆ†ã€‚



## çº¿ç¨‹ä¸è¿›ç¨‹çš„åŒºåˆ«

| åŒºåˆ«     | è¿›ç¨‹                                                         | çº¿ç¨‹                                                         |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| æ ¹æœ¬åŒºåˆ« | ä½œä¸ºèµ„æºåˆ†é…çš„å•ä½                                           | è°ƒåº¦å’Œæ‰§è¡Œçš„å•ä½                                             |
| å¼€é”€     | æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ç‹¬ç«‹çš„ä»£ç å’Œæ•°æ®ç©ºé—´ï¼ˆè¿›ç¨‹ä¸Šä¸‹æ–‡ï¼‰ï¼Œè¿›ç¨‹é—´çš„åˆ‡æ¢ä¼šæœ‰è¾ƒå¤§çš„å¼€é”€ | çº¿ç¨‹å¯ä»¥çœ‹æˆæ˜¯è½»é‡çº§çš„è¿›ç¨‹ï¼ŒåŒä¸€ç±»çº¿ç¨‹å…±äº«ä»£ç å’Œæ•°æ®ç©ºé—´ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰ç‹¬ç«‹çš„è¿è¡Œæ ˆå’Œç¨‹åºè®¡æ•°å™¨ï¼ˆPCï¼‰çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€å° |
| æ‰€å¤„ç¯å¢ƒ | åœ¨æ“ä½œç³»ç»Ÿä¸­èƒ½åŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡ï¼ˆç¨‹åºï¼‰                       | åœ¨åŒä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­æœ‰å¤šä¸ªé¡ºåºæµåŒæ—¶æ‰§è¡Œ                       |
| åˆ†é…å†…å­˜ | ç³»ç»Ÿåœ¨è¿è¡Œçš„æ—¶å€™ä¼šä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸åŒçš„å†…å­˜åŒºåŸŸ               | é™¤äº†CPUä¹‹å¤–ï¼Œä¸ä¼šä¸ºçº¿ç¨‹åˆ†é…å†…å­˜ï¼ˆçº¿ç¨‹æ‰€ä½¿ç”¨çš„èµ„æºæ˜¯å®ƒæ‰€å±çš„è¿›ç¨‹çš„èµ„æºï¼‰ï¼Œçº¿ç¨‹ç»„åªèƒ½å…±äº«èµ„æº |
| åŒ…å«å…³ç³» | æ²¡æœ‰çº¿ç¨‹çš„è¿›ç¨‹æ˜¯å¯ä»¥è¢«çœ‹ä½œå•çº¿ç¨‹çš„ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹å†…æ‹¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œåˆ™æ‰§è¡Œè¿‡ç¨‹ä¸æ˜¯ä¸€æ¡çº¿çš„ï¼Œè€Œæ˜¯å¤šæ¡çº¿ï¼ˆçº¿ç¨‹ï¼‰å…±åŒå®Œæˆçš„ | çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥çº¿ç¨‹æœ‰çš„æ—¶å€™è¢«ç§°ä¸ºè½»æƒè¿›ç¨‹æˆ–è½»é‡çº§è¿›ç¨‹ |



## çº¿ç¨‹çš„å®ç°

- Javaä¸­çº¿ç¨‹çš„å®ç°æ–¹å¼
  - åœ¨Javaä¸­è´Ÿè´£çº¿ç¨‹çš„è¿™ä¸ªåŠŸèƒ½æ˜¯ `Java.lang.Thread` ç±»
  - å¯ä»¥é€šè¿‡åˆ›å»º Thread çš„å®ä¾‹æ¥åˆ›å»ºæ–°çš„çº¿ç¨‹
  - æ¯ä¸ªçº¿ç¨‹éƒ½æ˜¯é€šè¿‡æŸä¸ªç‰¹å®š Thread å¯¹è±¡æ‰€å¯¹åº”çš„æ–¹æ³• `run()` æ¥å®Œæˆå…¶æ“ä½œçš„ï¼Œæ–¹æ³• `run()` ç§°ä¸ºçº¿ç¨‹ä½“
  - é€šè¿‡è°ƒç”¨ Thread ç±»çš„ `start()` æ–¹æ³•æ¥å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹



### åˆ›å»ºçº¿ç¨‹çš„ä¸¤ç§åŸºç¡€æ–¹å¼

#### æ–¹å¼ä¸€ï¼šç»§æ‰¿ `Thread` ç±»

##### æ“ä½œæ­¥éª¤

1. ç»§æ‰¿ `Thread` ç±»
2. é‡å†™ `run` æ–¹æ³•
3. åˆ›å»ºå¯¹è±¡ï¼Œè°ƒç”¨ `start()` æ–¹æ³•ï¼Œå¯åŠ¨çº¿ç¨‹

##### ä»£ç ç¤ºä¾‹

```java
public class ThreadDemo extends Thread {

    /**
     * ç¨‹åºå…¥åº“ï¼Œmain()æ–¹æ³•æ˜¯ç¨‹åºçš„ä¸»çº¿ç¨‹
     * @param args å‚æ•°
     */
    public static void main(String[] args) {
        ThreadDemo td = new ThreadDemo();
        // å¼€å¯çº¿ç¨‹ï¼Œè°ƒç”¨start()æ–¹æ³•ï¼Œçº¿ç¨‹å†…éƒ¨ä¼šè¿è¡Œrun()æ–¹æ³•
        td.start();
        for (int i = 0; i < 100; i++) {
            System.out.printf("main()æ–¹æ³•ï¼Œå½“å‰çº¿ç¨‹åç§°ã€Œ%sã€==> %d\n", Thread.currentThread().getName(), i);
        }
    }

    /**
     * é‡å†™Threadçˆ¶ç±»run()æ–¹æ³•ï¼Œå®ç°çº¿ç¨‹éœ€è¦è¿è¡Œçš„ä¸šåŠ¡é€»è¾‘
     */
    @Override
    public void run() {
        for (int i = 0; i < 1000; i++) {
            System.out.printf("run()æ–¹æ³•ï¼Œå½“å‰çº¿ç¨‹åç§°ã€Œ%sã€==> %d\n", Thread.currentThread().getName(), i);
        }
    }
}
```

##### å›¾è§£æ‰§è¡Œæµç¨‹

![image-20220616111524352](images/image-20220616111524352.png)

#### æ–¹å¼äºŒï¼šå®ç° `Runnable` æ¥å£

##### æ“ä½œæ­¥éª¤

1) å®ç° `Runnable` æ¥å£
2) é‡å†™ `run` æ–¹æ³•
3) åˆ›å»ºå¯¹è±¡ï¼Œè°ƒç”¨ `start()` æ–¹æ³•ï¼Œå¯åŠ¨çº¿ç¨‹

##### ä»£ç ç¤ºä¾‹

- [ğŸ”— å‚è€ƒä»£ç é“¾æ¥ ğŸ”—](https://github.com/witty-hamster/hard-core/blob/main/multithreading-and-high-concurrency/src/main/java/com/hamster/mahc/demo/RunnableDemo.java)

```java
public class RunnableDemo implements Runnable {

    public static void main(String[] args) {
        RunnableDemo rd = new RunnableDemo();
        Thread thread = new Thread(rd);
        thread.start();
        for (int i = 0; i < 100; i++) {
            System.out.printf("main()æ–¹æ³•ï¼Œå½“å‰çº¿ç¨‹åç§°ã€Œ%sã€==> %d\n", Thread.currentThread().getName(), i);
        }
    }

    /**
     * å®ç°æ¥å£ä¸­çš„run()æ–¹æ³•
     */
    @Override
    public void run() {
        for (int i = 0; i < 1000; i++) {
            System.out.printf("run()æ–¹æ³•ï¼Œå½“å‰çº¿ç¨‹åç§°ã€Œ%sã€==> %d\n", Thread.currentThread().getName(), i);
        }
    }
}
```



#### ä¸¤ç§å®ç°æ–¹å¼å¯¹æ¯”

> ğŸ¤”æ€è€ƒï¼šä¸¤ç§å®ç°æ–¹å¼å“ªç§ç”¨çš„æ¯”è¾ƒå¤šï¼Ÿï¼Ÿï¼Ÿ

- æ¨èä½¿ç”¨ç¬¬äºŒç§`Runnable`æ¥å£å®ç°æ–¹å¼
- åŸå› æœ‰ä»¥ä¸‹ä¸¤ç‚¹
  1. Java æ˜¯å•ç»§æ‰¿ï¼Œå°†ç»§æ‰¿å…³ç³»ç•™ç»™æœ€éœ€è¦çš„ç±»
  2. ä½¿ç”¨ Runnable æ¥å£ä¹‹åï¼Œä¸éœ€è¦ç»™å…±äº«å˜é‡æ·»åŠ  static å…³é”®å­—ï¼Œæ¯æ¬¡åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œä½œä¸ºå…±äº«å¯¹è±¡å³å¯
- ç»§æ‰¿ Threadç±»æ–¹å¼çš„ç¼ºç‚¹
  - å¦‚æœæˆ‘ä»¬çš„ç±»å·²ç»ä»ä¸€ä¸ªç±»ç»§æ‰¿ï¼Œåˆ™æ— æ³•å†ç»§æ‰¿ Threadç±»
- å®ç° Runnableæ¥å£æ–¹å¼çš„ä¼˜ç‚¹
  - å¯ä»¥åŒæ—¶å®ç°ç»§æ‰¿ï¼Œæ›´åŠ é€šç”¨ä¸€äº›
  - é¿å…Javaçš„å•ç»§æ‰¿
  - æ–¹ä¾¿å…±äº«èµ„æºï¼ŒåŒä¸€ä»½èµ„æºï¼Œå¯ä¾›å¤šä¸ªä»£ç†è®¿é—®

## Runnableã€Thread æ‰€ä½¿ç”¨çš„è®¾è®¡æ¨¡å¼

> ä½¿ç”¨äº†ä»£ç†è®¾è®¡æ¨¡å¼

- Runnable æ¥å£ï¼Œæ˜¯ä»£ç†ç±»å’Œè¢«ä»£ç†ç±»å…±åŒå®ç°çš„

- Thread ç±»ï¼Œæ˜¯ä»£ç†ç±»

- ç±»å›¾

  ![image-20220617161714556](images/image-20220617161714556.png)

## çº¿ç¨‹çŠ¶æ€

### å›¾è§£çº¿ç¨‹çŠ¶æ€

![image-20220620190632704](images/image-20220620190632704.png)

### çº¿ç¨‹çŠ¶æ€åˆ†ç±»

> JDKæºç ä¸­ï¼Œjava.lang.Thread.State æšä¸¾ç±»ä¸­è¯¦ç»†åˆ—ä¸¾äº†çº¿ç¨‹çš„çŠ¶æ€

#### æ–°ç”ŸçŠ¶æ€

- ç”¨ newå…³é”®å­—å»ºç«‹ä¸€ä¸ªçº¿ç¨‹åï¼Œè¯¥çº¿ç¨‹å¯¹è±¡å°±å¤„äºæ–°ç”ŸçŠ¶æ€
- å¤„äºæ–°ç”ŸçŠ¶æ€çš„çº¿ç¨‹æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ï¼Œé€šè¿‡è°ƒç”¨ start()æ–¹æ³•è¿›å…¥å°±ç»ªçŠ¶æ€

#### å°±ç»ªçŠ¶æ€

- å¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹å…·å¤‡äº†è¿è¡Œæ¡ä»¶ï¼Œä½†è¿˜æ²¡æœ‰åˆ†é…åˆ°CPUï¼Œå¤„äºçº¿ç¨‹å°±ç»ªé˜Ÿåˆ—ï¼Œç­‰å¾…ç³»ç»Ÿä¸ºå…¶åˆ†é…CPU
- å½“ç³»ç»Ÿé€‰å®šä¸€ä¸ªç­‰å¾…æ‰§è¡Œçš„çº¿ç¨‹åï¼Œå®ƒå°±ä¼šä»å°±ç»ªçŠ¶æ€è¿›å…¥æ‰§è¡ŒçŠ¶æ€ï¼Œè¯¥åŠ¨ä½œç§°ä¸º "CPUè°ƒåº¦"

#### è¿è¡ŒçŠ¶æ€

- åœ¨è¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹æ‰§è¡Œè‡ªå·±çš„ runæ–¹æ³•ä¸­ä»£ç ï¼Œç›´åˆ°ç­‰å¾…æŸèµ„æºè€Œé˜»å¡æˆ–è€…å®Œæˆä»»åŠ¡è€Œæ­»äº¡
- å¦‚æœåœ¨ç»™å®šçš„æ—¶é—´ç‰‡å†…æ²¡æœ‰æ‰§è¡Œç»“æŸï¼Œå°±ä¼šè¢«ç³»ç»Ÿç»™æ¢ä¸‹æ¥å›åˆ°ç­‰å¾…æ‰§è¡ŒçŠ¶æ€

#### é˜»å¡çŠ¶æ€

- å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹åœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆå¦‚æ‰§è¡Œäº† sleepï¼ˆç¡çœ ï¼‰æ–¹æ³•ï¼Œæˆ–è€…ç­‰å¾… I/Oè®¾å¤‡ç­‰èµ„æºï¼‰ï¼Œå°†è®©å‡ºCPUå¹¶æš‚æ—¶åœæ­¢è‡ªå·±è¿è¡Œï¼Œè¿›å…¥é˜»å¡çŠ¶æ€
- åœ¨é˜»å¡çŠ¶æ€çš„çº¿ç¨‹ä¸èƒ½è¿›å…¥å°±ç»ªé˜Ÿåˆ—ã€‚åªæœ‰å½“å¼•èµ·é˜»å¡çš„åŸå› æ¶ˆé™¤æ—¶ï¼ˆå¦‚ï¼Œç¡çœ æ—¶é—´å·²åˆ°ï¼Œæˆ–ç­‰å¾…çš„ I/Oè®¾å¤‡ç©ºé—²ä¸‹æ¥ï¼‰ï¼Œçº¿ç¨‹ä¾¿è½¬å…¥å°±ç»ªçŠ¶æ€ï¼Œé‡æ–°åˆ°å°±ç»ªé˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…ï¼Œè¢«ç³»ç»Ÿé€‰ä¸­åä»åŸæ¥åœæ­¢çš„ä½ç½®å¼€å§‹ç»§ç»­æ‰§è¡Œ

#### æ­»äº¡çŠ¶æ€

- æ­»äº¡çŠ¶æ€æ˜¯çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸä¸­çš„æœ€åä¸€ä¸ªé˜¶æ®µã€‚çº¿ç¨‹æ­»äº¡çš„åŸå› æœ‰ä¸‰ä¸ªï¼š
  1. æ­£å¸¸è¿è¡Œçš„çº¿ç¨‹å®Œæˆäº†å®ƒçš„å…¨éƒ¨å·¥ä½œ
  2. çº¿ç¨‹è¢«å¼ºåˆ¶æ€§çš„ç»ˆæ­¢ï¼Œå¦‚é€šè¿‡ stopæ–¹æ³•æ¥ç»ˆæ­¢ä¸€ä¸ªçº¿ç¨‹ï¼ˆæ­¤æ–¹æ³•ä¸æ¨èä½¿ç”¨ï¼‰
  3. çº¿ç¨‹æŠ›å‡ºæœªæ•è·çš„å¼‚å¸¸



## çº¿ç¨‹æ“ä½œå¸¸ç”¨API

| åºå· | æ–¹æ³•åç§°                                       | æè¿°                                                         |
| :--- | ---------------------------------------------- | ------------------------------------------------------------ |
| 1    | public static native Thread currentThread()    | è¿”å›ç›®å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹                                       |
| 2    | public final String getName()                  | è¿”å›çº¿ç¨‹çš„åç§°                                               |
| 3    | public final int getPriority()                 | è¿”å›çº¿ç¨‹çš„ä¼˜å…ˆçº§                                             |
| 4    | public final void setPriority(int newPriority) | è®¾å®šçº¿ç¨‹ä¼˜å…ˆçº§                                               |
| 5    | public final native boolean isAlive()          | åˆ¤æ–­çº¿ç¨‹æ˜¯å¦åœ¨æ´»åŠ¨ï¼Œå¦‚æœæ˜¯ï¼Œè¿”å›trueï¼›å¦åˆ™è¿”å›false          |
| 6    | public final void join()                       | è°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹å¼ºåˆ¶æ‰§è¡Œï¼Œå…¶ä»–çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼Œè¯¥çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åï¼Œå…¶å®ƒçº¿ç¨‹å†æ‰§è¡Œ |
| 7    | public static void sleep(long millis)          | ä½¿ç”¨å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ä¼‘çœ millisç§’ï¼Œçº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€         |
| 8    | public static void yield()                     | å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœä¸€æ¬¡ï¼Œå…è®¸å…¶ä»–çº¿ç¨‹æ‰§è¡Œï¼Œä¸é˜»å¡ï¼Œçº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–ç­‰å¾…æ‰§è¡Œçš„çº¿ç¨‹ï¼Œè¿™ä¸ªæ—¶å€™å½“å‰çº¿ç¨‹å°±ä¼šé©¬ä¸Šæ¢å¤æ‰§è¡Œ |
| 9    | public final void stop()                       | å¼ºè¿«çº¿ç¨‹åœæ­¢æ‰§è¡Œã€‚å·²è¿‡æ—¶ï¼Œä¸æ¨èä½¿ç”¨                         |



## é˜»å¡çŠ¶æ€

> ä¸‰ç§æš‚åœå½“å‰çº¿ç¨‹æ‰§è¡Œçš„æ–¹æ³•
>
> 	- sleep
> 	- yield
> 	- join

1. sleep
   - ä¸ä¼šé‡Šæ”¾é”ï¼ŒSleepæ—¶åˆ«çš„çº¿ç¨‹ä¹Ÿä¸å¯ä»¥è®¿é—®é”å®šå¯¹è±¡
2. yield
   - è®©å‡ºCPUçš„ä½¿ç”¨æƒï¼Œä»è¿è¡Œæ€ç›´æ¥è¿›å…¥å°±ç»ªæ€
   - è®©CPUé‡æ–°æŒ‘é€‰å“ªä¸€ä¸ªçº¿ç¨‹è¿›å…¥è¿è¡ŒçŠ¶æ€
3. join
   - å½“æŸä¸ªçº¿ç¨‹ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œç»“æŸåï¼Œæ‰ç»§ç»­æ‰§è¡Œ
   - ä½¿è°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹åœ¨æ­¤ä¹‹å‰æ‰§è¡Œå®Œæ¯•ï¼Œä¹Ÿå°±æ˜¯ç­‰å¾…è°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åå†å¾€ä¸‹ç»§ç»­æ‰§è¡Œ

## å…±äº«èµ„æºä¸ä¸€è‡´ç°è±¡

- ç”±äºçº¿ç¨‹ä¸åŒæ­¥ï¼Œå¯¼è‡´å…±äº«èµ„æºä¸ä¸€è‡´

![image-20220623181631047](images/image-20220623181631047.png)

### å¦‚ä½•è§£å†³å¤šçº¿ç¨‹çš„å®‰å…¨æ€§é—®é¢˜ï¼Ÿ

> ä¸¤ç§æ–¹å¼ï¼š
>
> - åŒæ­¥ä»£ç å—
> - åŒæ­¥æ–¹æ³•

- çº¿ç¨‹åŒæ­¥çš„å‰ææ¡ä»¶
  - å¿…é¡»æœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹
  - å¿…é¡»æ˜¯å¤šä¸ªçº¿ç¨‹ä½¿ç”¨åŒä¸€èµ„æº
  - å¿…é¡»ä¿è¯åŒæ­¥ä¸­åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨è¿è¡Œ

- åŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜

  ```java
  public class TickerSafe1 implements Runnable {
  
      /** å®šä¹‰ç¥¨çš„ä¸ªæ•° */
      private int ticker = 5;
  
      @Override
      public void run() {
          // å¤„ç†è´­ç¥¨é€»è¾‘
          for (int i = 0; i < 10; i++) {
              try {
                  // æ¨¡æ‹Ÿå–ç¥¨è¿‡ç¨‹
                  Thread.sleep(300);
              } catch (InterruptedException e) {
                  e.printStackTrace();
              }
              // åŒæ­¥ä»£ç å— ==> é€šå¸¸å°†å½“å‰å¯¹è±¡ä½œä¸ºåŒæ­¥å¯¹è±¡
              synchronized (this) {
                  if (ticker > 0) {
                      System.out.printf("%sç”¨æˆ·æ­£åœ¨ä¹°ç¬¬%då¼ ç¥¨\n", Thread.currentThread().getName(), ticker--);
                  }
              }
          }
      }
  
      public static void main(String[] args) {
          TickerSafe1 tickerRunnable = new TickerSafe1();
          Thread t1 = new Thread(tickerRunnable);
          Thread t2 = new Thread(tickerRunnable);
          Thread t3 = new Thread(tickerRunnable);
          Thread t4 = new Thread(tickerRunnable);
  
          t1.start();
          t2.start();
          t3.start();
          t4.start();
      }
  }
  ```

- åŒæ­¥æ–¹æ³•è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜

  ```java
  public class TickerSafe2 implements Runnable {
  
      /** å®šä¹‰ç¥¨çš„ä¸ªæ•° */
      private int ticker = 5;
  
      @Override
      public void run() {
          // å¤„ç†è´­ç¥¨é€»è¾‘
          for (int i = 0; i < 10; i++) {
              try {
                  // æ¨¡æ‹Ÿå–ç¥¨è¿‡ç¨‹
                  Thread.sleep(300);
              } catch (InterruptedException e) {
                  e.printStackTrace();
              }
              sale();
          }
      }
  
      /**
       * ä½¿ç”¨åŒæ­¥æ–¹æ³•ï¼Œè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜
       */
      public synchronized void sale() {
          if (ticker > 0) {
              System.out.printf("%sç”¨æˆ·æ­£åœ¨ä¹°ç¬¬%då¼ ç¥¨\n", Thread.currentThread().getName(), ticker--);
          }
      }
  
      public static void main(String[] args) {
          TickerSafe2 tickerRunnable = new TickerSafe2();
          Thread t1 = new Thread(tickerRunnable);
          Thread t2 = new Thread(tickerRunnable);
          Thread t3 = new Thread(tickerRunnable);
          Thread t4 = new Thread(tickerRunnable);
  
          t1.start();
          t2.start();
          t3.start();
          t4.start();
      }
  }
  ```



### åŒæ­¥ç›‘è§†å™¨

- synchronized(obj){}ï¼Œä¸­çš„ obj ç§°ä¸ºåŒæ­¥ç›‘è§†å™¨
- åŒæ­¥ä»£ç å—ä¸­åŒæ­¥ç›‘è§†å™¨å¯ä»¥æ˜¯ä»»ä½•å¯¹è±¡ï¼Œä½†æ˜¯æ¨èä½¿ç”¨å…±äº«èµ„æºä½œä¸ºåŒæ­¥ç›‘è§†å™¨
- åŒæ­¥æ–¹æ³•ä¸­æ— éœ€æŒ‡å®šåŒæ­¥ç›‘è§†å™¨ï¼Œå› ä¸ºåŒæ­¥æ–¹æ³•çš„ç›‘è§†å™¨æ˜¯ thisï¼Œä¹Ÿå°±æ˜¯è¯¥å¯¹è±¡æœ¬èº«

### åŒæ­¥ç›‘è§†å™¨çš„æ‰§è¡Œè¿‡ç¨‹

- ç¬¬ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œé”å®šåŒæ­¥ç›‘è§†å™¨ï¼Œæ‰§è¡Œå…¶ä¸­ä»£ç 
- ç¬¬äºŒä¸ªçº¿ç¨‹è®¿é—®ï¼Œå‘ç°åŒæ­¥ç›‘è§†å™¨è¢«é”å®šï¼Œæ— æ³•è®¿é—®
- ç¬¬ä¸€ä¸ªçº¿ç¨‹è®¿é—®å®Œæ¯•ï¼Œè§£é”åŒæ­¥ç›‘è§†å™¨
- ç¬¬äºŒä¸ªçº¿ç¨‹è®¿é—®ï¼Œå‘ç°åŒæ­¥ç›‘è§†å™¨æœªé”ï¼Œé”å®šå¹¶è®¿é—®

## æ­»é”

### ä»€ä¹ˆæ˜¯æ­»é”

> å‡è®¾æœ‰ä¸¤ä¸ªçº¿ç¨‹Aã€Bï¼ŒåŒæ—¶æä¾›ä¸¤ä¸ªèµ„æºç”²ã€ä¹™ã€‚ç°æœ‰å¦‚ä¸‹æƒ…å†µï¼Œèµ„æºç”²ç»™åˆ°äº†çº¿ç¨‹Aï¼Œèµ„æºä¹™ç»™åˆ°äº†çº¿ç¨‹Bï¼Œä½†æ˜¯çº¿ç¨‹Aå¦‚æœæƒ³è¦è¿è¡Œï¼Œå¿…é¡»åŒæ—¶æ‹¥æœ‰èµ„æºç”²ã€èµ„æºä¹™ã€‚åŒæ ·ï¼Œçº¿ç¨‹Bä¹Ÿæ˜¯åŒæ—¶éœ€è¦ç”²ã€ä¹™ä¸¤ä¸ªèµ„æºæ—¶ï¼Œæ‰èƒ½è¿è¡Œã€‚ç”±äºèµ„æºä¹™è¢«çº¿ç¨‹Bå ç”¨ç€ï¼Œå¯¼è‡´çº¿ç¨‹Aè·å–ä¸åˆ°èµ„æºä¹™ï¼›åŒæ ·é—®é¢˜ä¹Ÿå‡ºç°åœ¨çº¿ç¨‹Bä¸Šï¼Œå› æ­¤å‡ºç°äº†æ­»é”ã€‚è°éƒ½ä¸é‡Šæ”¾èµ„æºï¼Œé‚£ä¹ˆè°ä¹Ÿä¸èƒ½è¿è¡Œã€‚

- æ­»é”ç°è±¡ç¤ºä¾‹å›¾

![image-20220624111145756](images/image-20220624111145756.png)		

- çº¿ç¨‹åŒæ­¥å¯ä»¥ä¿è¯èµ„æºå…±äº«æ“ä½œçš„æ­£ç¡®æ€§ï¼Œä½†æ˜¯è¿‡å¤šçš„åŒæ­¥ä¹Ÿä¼šäº§ç”Ÿæ­»é”
- æ­»é”ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¡¨ç¤ºäº’ç›¸ç­‰å¾…ï¼Œæ˜¯ç¨‹åºè¿è¡Œæ—¶å‡ºç°çš„ä¸€ç§é—®é¢˜

## çº¿ç¨‹çš„ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…

- åˆ†æç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…

  ![image-20220624143822982](images/image-20220624143822982.png)

  - ç”Ÿäº§è€…ä¸æ–­ç”Ÿäº§ï¼Œæ¶ˆè´¹è€…ä¸æ–­å–èµ°ç”Ÿäº§è€…ç”Ÿäº§çš„äº§å“
  - ç”Ÿäº§è€…ç”Ÿäº§äº§å“æ”¾åˆ°ä¸€ä¸ªåŒºåŸŸä¸­ï¼ˆå…±äº«èµ„æºï¼šå¯ä»¥æ˜¯å…±äº«å¯¹è±¡ã€å…±äº«å˜é‡ç­‰ï¼‰ï¼Œä¹‹åæ¶ˆè´¹è€…ä»æ­¤åŒºåŸŸé‡Œå–å‡ºäº§å“

### çº¿ç¨‹é—´çš„é€šä¿¡

- Java æä¾›äº†3ä¸ªæ–¹æ³•ï¼Œè§£å†³çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡é—®é¢˜

| æ–¹æ³•å                                   | ä½œç”¨                                                         |
| ---------------------------------------- | ------------------------------------------------------------ |
| final void wait()                        | è¡¨ç¤ºçº¿ç¨‹ä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹é€šçŸ¥                           |
| final void wait(long timeout)            | è¡¨ç¤ºçº¿ç¨‹ç­‰å¾…æŒ‡å®šæ¯«ç§’å‚æ•°çš„æ—¶é—´                               |
| final void wait(long timeout, int nanos) | è¡¨ç¤ºçº¿ç¨‹ç­‰å¾…æŒ‡å®šæ¯«ç§’ã€å¾®ç§’çš„æ—¶é—´                             |
| final void notify()                      | è¡¨ç¤ºå”¤é†’ä¸€ä¸ªå¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹                               |
| final void notifyAll()                   | è¡¨ç¤ºå”¤é†’åŒä¸€ä¸ªå¯¹è±¡ä¸Šæ‰€æœ‰è°ƒç”¨wait()æ–¹æ³•çš„çº¿ç¨‹ï¼Œä¼˜å…ˆçº§åˆ«é«˜çš„çº¿ç¨‹ä¼˜å…ˆè¿è¡Œ |

> æ³¨æ„äº‹é¡¹ï¼šä»¥ä¸Šæ–¹æ³•éƒ½åªèƒ½åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥ä»£ç å—ä¸­ä½¿ç”¨ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸

### Object ç±»ä¸­çš„ç­‰å¾…ä¸å”¤é†’

![image-20220624171322000](images/image-20220624171322000.png)
